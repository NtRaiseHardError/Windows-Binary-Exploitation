# RM to MP3 Converter

Exploit to pop _calc.exe_ for RM to MP3 Converter v2.7.3.700 on Windows XP.

Note: executes shellcode in the stack; does **NOT** defeat DEP.

Tested on Windows XP SP3.

![exploit](https://github.com/NtRaiseHardError/Windows-Binary-Exploitation/blob/master/Corelan/Corelan-Tutorials/RM-to-MP3-Converter/exploit.png)

## Related Tutorials:

* https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/

* https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/

## How 2 use:

1. Generate the .m3u file by running [`exploit.py`](https://raw.githubusercontent.com/NtRaiseHardError/Windows-Binary-Exploitation/master/Corelan/Corelan-Tutorials/RM-to-MP3-Converter/exploit.py)
2. Load the .m3u file into the RM to MP3 Converter
3. Hope that the exploit works (because it's pretty unreliable :( )
4. If it doesn't work, try again until it does!

## Example exploit file

* https://raw.githubusercontent.com/NtRaiseHardError/Windows-Binary-Exploitation/master/Corelan/Corelan-Tutorials/RM-to-MP3-Converter/exploit.m3u

## Discovery

By default, Windows XP SP3 ships with the `OptIn` DEP option which protects only the system binaries meaning that third party applications such as _RM to MP3 Converter_ are not<sup>[Microsoft](https://support.microsoft.com/en-us/help/875352/a-detailed-description-of-the-data-execution-prevention-dep-feature-in)</sup>. Because of this, shellcode can be executed on the stack as demonstrated in the provided example exploit. To enable DEP for all processes, the DEP configuration must be changed to either `OptOut`(?) or `AlwaysOn`. The `IMAGE_DLLCHARACTERISTICS_NX_COMPAT` flag in the PE header's Optional Header's `DllCharacteristics` field is not required to be set for DEP support.
